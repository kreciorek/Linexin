#!/bin/bash

# Re-generate initramfs images
mkinitcpio -P

# Install systemd-boot
bootctl --esp-path=/boot --boot-path=/boot install

# Create loader configuration
cat > /boot/loader/loader.conf <<EOF
default  linexin.conf
timeout  0
console-mode max
editor   no
EOF

# Create boot entry
ROOT_UUID=$(findmnt -no UUID /)
cat > /boot/loader/entries/linexin.conf <<EOF
title    linexin
linux    /vmlinuz-linux
initrd   /initramfs-linux.img
options  quiet splash root=UUID=$ROOT_UUID rw
EOF
